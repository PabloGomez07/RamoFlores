<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üåº Feliz D√≠a de la Primavera</title>
  <meta name="theme-color" content="#ffd54f" />
  <style>
    :root{ --amarillo:#ffd54f; --amarillo-2:#ffeb3b; --texto:#2a2a2a; --sombra:0 10px 30px rgba(0,0,0,.15); }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;color:var(--texto);background:radial-gradient(1200px 600px at 10% -10%,#fff9c4 0%,#fffde7 30%,#fff 60%);overflow:hidden}

    .wrap{height:100%;display:grid;grid-template-rows:auto 1fr auto}
    header{padding:18px 20px 8px;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    .logo{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,var(--amarillo),var(--amarillo-2));box-shadow:var(--sombra);display:grid;place-items:center;font-size:22px}
    .counter{display:flex;align-items:center;gap:8px;background:#fff;border-radius:999px;padding:8px 14px;box-shadow:var(--sombra);font-weight:700}
    .counter .dot{width:10px;height:10px;border-radius:999px;background:var(--amarillo-2);box-shadow:0 0 0 4px rgba(255,235,59,.25)}

    main{position:relative;overflow:hidden;display:grid;place-items:center;padding:10px}
    .card{width:min(860px,94vw);background:linear-gradient(180deg,#fff,#fff7d6);border:1px solid #ffe082;border-radius:22px;padding:28px;box-shadow:var(--sombra);text-align:center}
    h1{margin:0 0 8px;font-size:clamp(24px,4.6vw,40px)}
    p.sub{margin:0 0 18px;opacity:.85}
    .btns{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
    button{border:0;cursor:pointer;background:linear-gradient(135deg,var(--amarillo-2),var(--amarillo));color:#5a4100;font-weight:800;padding:12px 18px;border-radius:14px;box-shadow:var(--sombra)}
    .ghost{background:#fff;border:1px solid #ffe082;color:#6b5600}

    /* Flores / corazones grandes */
    .flower{position:absolute;left:0;top:0;font-size:clamp(40px,12vw,80px);pointer-events:none;filter:drop-shadow(0 6px 10px rgba(0,0,0,.2));animation:floatUp 3.5s ease-out forwards}
    @keyframes floatUp{0%{transform:translate(-50%,-10%) scale(.5);opacity:0}15%{opacity:1}100%{transform:translate(var(--dx),-120vh) scale(1.2);opacity:0}}

    .toast{position:absolute;left:50%;top:18%;transform:translateX(-50%);background:#fff;border:1px solid #ffe082;border-radius:14px;padding:14px 18px;font-size:clamp(18px,4vw,26px);box-shadow:var(--sombra);font-weight:600;opacity:0;animation:pop .2s ease-out forwards,fadeOut 2.6s ease 1.8s forwards}
    @keyframes pop{from{transform:translate(-50%,-6px) scale(.92);opacity:0}to{transform:translate(-50%,0) scale(1);opacity:1}}
    @keyframes fadeOut{to{opacity:0;transform:translate(-50%,6px) scale(.98)}}

    footer{padding:14px;display:flex;justify-content:center}
    .tiny{font-size:12.5px;opacity:.7}

    .bubble{position:absolute;border-radius:999px;background:radial-gradient(circle at 30% 30%,#fff59d,#fdd835);opacity:.35;filter:blur(6px);pointer-events:none;animation:rise 10s linear infinite}
    @keyframes rise{from{transform:translateY(0)}to{transform:translateY(-120vh)}}

    /* Golden retriever (SVG) */
    .golden{position:absolute;left:0;top:0;width:clamp(96px,22vw,220px);height:clamp(72px,16vw,160px);pointer-events:none;background-size:contain;background-repeat:no-repeat;background-position:center;filter:drop-shadow(0 8px 14px rgba(0,0,0,.25));animation:goldenFloat 3s ease-out forwards}
    @keyframes goldenFloat{0%{transform:translate(-50%,20%) scale(.8) rotate(-2deg);opacity:0}15%{opacity:1}100%{transform:translate(var(--dx),-120vh) scale(1) rotate(2deg);opacity:0}}

    /* Nota "juntos desde" */
    .since-note{font-size:13px; opacity:.9; margin-top:6px; text-align:center}

    /* Estetoscopio */
    .steth{position:absolute; left:0; top:0; font-size:clamp(36px,10vw,72px); pointer-events:none; filter:drop-shadow(0 6px 10px rgba(0,0,0,.2)); animation:floatUp 2.8s ease-out forwards}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand"><div class="logo">üåº</div><div>Primavera <span style="opacity:.6">/ para vos</span></div></div>
      <div class="counter"><span class="dot"></span><span id="count">0</span><span>flores</span></div>
      <div class="counter" id="since-wrap" aria-live="polite" title="Tiempo desde 15/01/2018">
        <span class="dot" aria-hidden="true"></span>
        <span id="since"></span>
      </div>
      <div class="since-note" id="since-note">üíõ Am√°ndonos desde el <strong>15/01/2018</strong></div>
    </header>

    <main id="stage">
      <div class="card">
        <h1>Feliz D√≠a de la Primavera üíõ</h1>
        <p class="sub">Cada toque agrega una flor amarilla, un coraz√≥n o un golden üêï</p>
        <div class="btns">
          <button id="btn-add">Agregar üåº</button>
          <button class="ghost" id="btn-full">Pantalla completa</button>
          <button class="ghost" id="btn-reset">Reiniciar</button>
          <button class="ghost" id="btn-share">Compartir</button>
          <button class="ghost" id="btn-music">M√∫sica ‚ñ∂Ô∏è</button>
        </div>
      </div>

      <!-- Modal con YouTube -->
      <dialog id="music-modal" class="modal">
        <div class="modal-card">
          <div class="modal-head">
            <strong>üéµ Chasing Cars ‚Äî Snow Patrol (YouTube)</strong>
            <div class="btns">
              <button id="btn-play" class="ghost">‚ñ∂Ô∏è Reproducir</button>
              <button id="btn-pause" class="ghost">‚è∏Ô∏è Pausa</button>
              <button id="btn-mute" class="ghost">üîá Mute</button>
              <button id="btn-close-modal" class="ghost">Cerrar</button>
            </div>
          </div>
          <div class="modal-body">
            <div id="yt-player" style="aspect-ratio:16/9;width:100%;background:#000;border-radius:12px;overflow:hidden"></div>
            <div class="tiny">Si el reproductor no carga, <a href="https://www.youtube.com/watch?v=GemKqzILV4w" target="_blank">abr√≠ el video en YouTube</a>.</div>
          </div>
        </div>
      </dialog>
    </main>

    <footer><div class="tiny">Hecho con üåºüêï y un poco de <code>&lt;code/&gt;</code></div></footer>
  </div>

  <script>
    // ====== SELECTORES ======
    const stage = document.getElementById('stage');
    const btnAdd = document.getElementById('btn-add');
    const btnFull = document.getElementById('btn-full');
    const btnReset = document.getElementById('btn-reset');
    const btnShare = document.getElementById('btn-share');
    const btnMusic = document.getElementById('btn-music');
    const musicModal = document.getElementById('music-modal');
    const btnCloseModal = document.getElementById('btn-close-modal');
    const btnPlay = document.getElementById('btn-play');
    const btnPause = document.getElementById('btn-pause');
    const btnMute = document.getElementById('btn-mute');
    const countEl = document.getElementById('count');

    // ====== DATA ======
    const emojis = ['üåº','üåª','üíõ','‚ú®'];
    const mensajes = [
      'Sos mi estaci√≥n favorita','Con vos todo florece','Mi color preferido: tu sonrisa','M√°s vos, menos fr√≠o','Mi primavera empieza cuando te veo','Te elijo hoy y todos los d√≠as','Sos sol de tarde linda','Te pienso y florezco','Qu√© suerte la m√≠a de encontrarte','Plan A: Vos. Plan B: Vos.'
    ];
    let count = 0;
    const DOG_PROB = 25; // % de probabilidad de perro

    // ====== CONTADOR EN TIEMPO REAL DESDE 15/01/2018 ======
    const SINCE_START = new Date(2018, 0, 15, 0, 0, 0); // 15 enero 2018
    const sinceEl = document.getElementById('since');

    function pad(n){ return String(n).padStart(2,'0'); }
    function diffCalendar(from, to){
      let a = new Date(from.getTime());
      const b = to;
      let years = b.getFullYear() - a.getFullYear();
      a.setFullYear(a.getFullYear() + years);
      if(a > b){ years--; a.setFullYear(a.getFullYear() - 1); }
      let months = b.getMonth() - a.getMonth();
      if(months < 0){ months += 12; }
      a.setMonth(a.getMonth() + months);
      if(a > b){ months--; a.setMonth(a.getMonth() - 1); }
      const ms1 = b - a; const days = Math.floor(ms1 / 86400000); a.setDate(a.getDate() + days);
      const ms2 = b - a; const hours = Math.floor(ms2 / 3600000); a.setHours(a.getHours() + hours);
      const ms3 = b - a; const minutes = Math.floor(ms3 / 60000); a.setMinutes(a.getMinutes() + minutes);
      const ms4 = b - a; const seconds = Math.floor(ms4 / 1000);
      return { years, months, days, hours, minutes, seconds };
    }
    function renderSince(){
      const now = new Date();
      const d = diffCalendar(SINCE_START, now);
      sinceEl.textContent = `${d.years}a ${d.months}m ${d.days}d ${pad(d.hours)}:${pad(d.minutes)}:${pad(d.seconds)}`;
      const human = `${d.years} a√±o${d.years!==1?'s':''}, ${d.months} mes${d.months!==1?'es':''} y ${d.days} d√≠a${d.days!==1?'s':''}`;
      const note = document.getElementById('since-note');
      if(note){ note.innerHTML = `üíõ Am√°ndonos desde el <strong>15/01/2018</strong>: <em>${human}</em>`; }
    }

    // ====== RENDER ======
    function postSpawn(){ count++; countEl.textContent = count; showToast(); spawnBubbles(); }

    function addFlower(x=null, y=null){
      const rect = stage.getBoundingClientRect();
      if(Math.random()*100 < DOG_PROB){ spawnDog(x, y); postSpawn(); return; }
      const el = document.createElement('div');
      el.className = 'flower';
      el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      const posX = x ?? (Math.random()*rect.width);
      const posY = y ?? (rect.height*0.85);
      el.style.left = posX + 'px';
      el.style.top = posY + 'px';
      el.style.setProperty('--dx', (Math.random()*240 - 120) + 'px');
      stage.appendChild(el);
      setTimeout(()=>el.remove(), 4200);
      postSpawn();
    }

    function showToast(){
      const t = document.createElement('div');
      t.className = 'toast';
      t.textContent = mensajes[Math.floor(Math.random()*mensajes.length)];
      stage.appendChild(t);
      setTimeout(()=>t.remove(), 3000);
    }

    function spawnBubbles(){
      for(let i=0;i<3;i++){
        const b = document.createElement('div');
        const size = 20 + Math.random()*40;
        b.className = 'bubble';
        b.style.width = b.style.height = size + 'px';
        b.style.left = (Math.random()*100) + '%';
        b.style.bottom = '-' + (20 + Math.random()*40) + 'px';
        b.style.animationDuration = (7 + Math.random()*5) + 's';
        stage.appendChild(b);
        setTimeout(()=>b.remove(), 12000);
      }
    }

    // ====== GOLDEN (SVG) y variantes de perro ======
    const GOLDEN_SVG = encodeURIComponent(`
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 220'>
        <defs>
          <linearGradient id='fur' x1='0' y1='0' x2='1' y2='1'>
            <stop offset='0%' stop-color='#f5c04e'/>
            <stop offset='100%' stop-color='#e0a832'/>
          </linearGradient>
        </defs>
        <ellipse cx='150' cy='130' rx='120' ry='70' fill='url(#fur)'/>
        <circle cx='250' cy='90' r='46' fill='url(#fur)'/>
        <path d='M230 70 q-18 20 0 46 q18-10 18-30 z' fill='#d79a2a' opacity='.9'/>
        <ellipse cx='275' cy='102' rx='22' ry='16' fill='#e9be4a'/>
        <circle cx='288' cy='100' r='6' fill='#333'/>
        <circle cx='262' cy='85' r='5' fill='#333'/>
        <rect x='90' y='170' width='20' height='38' rx='8' fill='#e0a832'/>
        <rect x='130' y='175' width='20' height='34' rx='8' fill='#e0a832'/>
        <rect x='190' y='170' width='20' height='38' rx='8' fill='#e0a832'/>
        <rect x='225' y='175' width='20' height='34' rx='8' fill='#e0a832'/>
        <path d='M40 130 q-40 -10 -30 -40 q50 10 90 20' stroke='#e0a832' stroke-width='18' fill='none' stroke-linecap='round'/>
        <ellipse cx='240' cy='70' rx='18' ry='10' fill='#fff' opacity='.2'/>
      </svg>`);

    function spawnDog(x=null, y=null){
      const rect = stage.getBoundingClientRect();
      const variant = Math.random() < 0.5 ? 'svg' : 'emoji';
      if(variant === 'emoji'){
        const el = document.createElement('div');
        el.className = 'flower';
        el.textContent = Math.random() < 0.5 ? 'üê∂' : 'üêï';
        const posX = x ?? (Math.random()*rect.width);
        const posY = y ?? (rect.height*0.85);
        el.style.left = posX + 'px';
        el.style.top = posY + 'px';
        el.style.setProperty('--dx', (Math.random()*200 - 100) + 'px');
        stage.appendChild(el);
        setTimeout(()=>el.remove(), 4200);
        return;
      }
      const g = document.createElement('div');
      g.className = 'golden';
      g.style.backgroundImage = `url("data:image/svg+xml;charset=UTF-8,${GOLDEN_SVG}")`;
      const posX = x ?? (rect.width * (0.2 + Math.random()*0.6));
      const posY = y ?? (rect.height * 0.9);
      g.style.left = posX + 'px';
      g.style.top = posY + 'px';
      g.style.setProperty('--dx', (Math.random()*200 - 100) + 'px');
      stage.appendChild(g);
      setTimeout(()=>g.remove(), 4200);
    }

    function spawnStethoscope(x=null, y=null){
      const rect = stage.getBoundingClientRect();
      const el = document.createElement('div');
      el.className = 'steth';
      el.textContent = 'ü©∫';
      const posX = x ?? (Math.random()*rect.width);
      const posY = y ?? (rect.height*0.8);
      el.style.left = posX + 'px';
      el.style.top = posY + 'px';
      el.style.setProperty('--dx', (Math.random()*200 - 100) + 'px');
      stage.appendChild(el);
      setTimeout(()=> el.remove(), 3200);
    }

    // ====== EVENTOS ======
    btnAdd.addEventListener('click', ()=> { addFlower(); spawnStethoscope(); });
    stage.addEventListener('click', (e)=>{
      if(e.target.closest('button')) return;
      const rect = stage.getBoundingClientRect();
      const x = e.clientX - rect.left, y = e.clientY - rect.top;
      addFlower(x, y);
      spawnStethoscope(x, y);
    });
    btnReset.addEventListener('click', ()=>{ count = 0; countEl.textContent = '0'; stage.querySelectorAll('.flower,.toast,.bubble,.golden,.steth').forEach(n=>n.remove()); });
    btnFull.addEventListener('click', ()=>{ const el = document.documentElement; if(!document.fullscreenElement){ el.requestFullscreen?.(); } else { document.exitFullscreen?.(); } });
    btnShare.addEventListener('click', ()=>{ const text = 'üåº Te hice esta mini app de flores amarillas porque sos mi primavera üíõ'; const url = location.href; const w = `https://wa.me/?text=${encodeURIComponent(text+' '+url)}`; window.open(w,'_blank'); });

    // ====== YOUTUBE IFRAME API + FALLBACK ======
    const YT_VIDEO_ID = 'GemKqzILV4w'; // Snow Patrol - Chasing Cars (Official)
    let ytPlayer = null; let ytReady = false;
    window.onYouTubeIframeAPIReady = function(){ ytReady = true; ytPlayer = new YT.Player('yt-player', { width:'100%', height:'100%', videoId:YT_VIDEO_ID, playerVars:{rel:0,modestbranding:1,playsinline:1}, events:{ onReady:()=>{} } }); };
    (function loadYT(){ const tag=document.createElement('script'); tag.src='https://www.youtube.com/iframe_api'; tag.onerror=()=> setTimeout(embedFallback,1000); document.body.appendChild(tag); setTimeout(()=>{ if(!ytReady && !ytPlayer) embedFallback(); },3000); })();
    function embedFallback(){ if(ytPlayer) return; const c=document.getElementById('yt-player'); c.innerHTML = `<iframe width="100%" height="100%" src="https://www.youtube.com/embed/${YT_VIDEO_ID}?rel=0&modestbranding=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`; }
    btnMusic.addEventListener('click', ()=>{ musicModal.setAttribute('open',''); });
    btnCloseModal.addEventListener('click', ()=>{ musicModal.removeAttribute('open'); try{ ytPlayer && ytPlayer.pauseVideo(); }catch(e){} });
    btnPlay.addEventListener('click', ()=>{ try{ ytPlayer && ytPlayer.playVideo(); }catch(e){} });
    btnPause.addEventListener('click', ()=>{ try{ ytPlayer && ytPlayer.pauseVideo(); }catch(e){} });
    btnMute.addEventListener('click', ()=>{ try{ if(!ytPlayer) return; if(ytPlayer.isMuted()){ ytPlayer.unMute(); btnMute.textContent='üîá Mute'; } else { ytPlayer.mute(); btnMute.textContent='üîä Unmute'; } }catch(e){} });

    // ====== ARRANQUE ======
    renderSince();
    setInterval(renderSince, 1000);
    setTimeout(()=>{ addFlower(); addFlower(); spawnStethoscope(); }, 400);
    setTimeout(()=>{ spawnDog(); postSpawn(); }, 900);
  </script>
</body>
</html>
